{"version":3,"file":"index.js","sources":["../src/compiler/index.js","../src/util.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function compileToFunction(template) {\n    console.log('compile')\n}","export function isFunction (val) {\n    return typeof val === 'function';\n}\n\nexport function isObject (val) {\n    return typeof val === 'object' && val !== null;\n}","let oldArrayProperty = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProperty);\n\nlet methods = [\n    'push',\n    'shift',\n    'unshift',\n    'reverse',\n    'pop',\n    'sort',\n    'splice'\n];\n\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        oldArrayProperty[method].call(this, ...args);\n        //监听调用方法时对数组的添加\n        let inserted;\n        let ob = this.__ob__;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n\n        if(inserted) ob.observeArray(inserted);\n    }\n})\n","import { isObject } from \"../util\";\nimport { arrayMethods } from \"./array\";\n\nclass Observer {\n    constructor (data) {\n        //防止死循环、设置为不可枚举\n        Object.defineProperty(data, '__ob__', {\n            value: this,\n            enumerable: false\n        })\n        if (Array.isArray(data)) {\n            data.__proto__ = arrayMethods;\n            //数组中是对象类型需要监控\n            this.observeArray(data);\n        }else {\n            this.walk(data);\n        }\n    }\n\n    observeArray (data) {\n        data.forEach(item => observe(item));\n    }\n\n    walk (data) {\n        Object.keys(data).forEach(key => {\n            defineReactive(data, key, data[key])\n        })\n    }\n}\n\nfunction defineReactive (data, key, value) {\n    observe(value)\n    Object.defineProperty(data, key, {\n        get () {\n            return value;\n        },\n        set (newV) {\n            observe(newV);\n            value = newV;\n        }\n    })\n}\n\nexport function observe (data) {\n    if (!isObject(data)) {\n        return;\n    }\n\n    //被监控过\n    if (data.__ob__) {\n        return;\n    }\n\n    return new Observer(data);\n}","import { isFunction } from \"./util\";\nimport { observe } from './observer/index';\n\nexport function initSate (vm) {\n    const opts = vm.$options;\n    if (opts.data) {\n        initData(vm);\n    }\n}\n\nfunction proxy (vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get () {\n            return vm[source][key];\n        },\n        set (newValue) {\n            vm[source][key] = newValue;\n        }\n    })\n}\n\nfunction initData (vm) {\n    let data = vm.$options.data;\n\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\n\n    for (let key in data) {\n        console.log(key)\n        proxy(vm, '_data', key);\n    }\n\n    observe(data);\n}","import { compileToFunction } from './compiler/index.js';\nimport { initSate } from './state';\n\nexport function initMixin (Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this;\n        vm.$options = options;\n\n        //对数据进行初始化 watch、props ...\n        initSate(vm);\n\n        if(vm.$options.el) {\n            vm.$mount(vm.$options.el);\n        }\n    }\n\n    Vue.prototype.$mount = function (el) {\n        const vm = this;\n        const options = vm.$options;\n        el = document.querySelector(el);\n        \n        if(!options.render) {\n            let template = options.template;\n            if (! template && el) {\n                template = el.outHTML;\n                let render = compileToFunction(template);\n                options.render = render;\n            }\n        }\n    }\n}","import { initMixin }from \"./init\";\n\nfunction Vue(options) {\n    this._init(options); \n}\n\ninitMixin(Vue);\n\nexport default Vue;"],"names":[],"mappings":"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"}